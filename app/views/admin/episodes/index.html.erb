<div class="hf-section">
  <div class="justify-content-between w-100 d-flex">
    <h2><%= t('sidebar.admin.manage.episodes') %></h2>
    <div class="dropdown">
      <%= link_to('Add episode', '#', id: 'add-episodes', class: 'btn btn-secondary btn-sm dropdown-toggle', "data-toggle": "dropdown", "aria-haspopup": "true", "aria-expanded": "false") %>
      <div class="dropdown-menu  dropdown-menu-right hf-dropdown" aria-labelledby="add-episodes">
        <a class="dropdown-item" add-option="from-files" href="#">From files...</a>
        <a class="dropdown-item" add-option="manually" href="#">Manually (coming soon)...</a>
      </div>
    </div>
  </div>
  <h6 class="text-muted"><%= @show.get_title %></h6>
</div>

<div id="from-files" class="d-none">
  <%= render partial: 'from_files' %>
</div>

<table id="current-episodes" class="table">
  <thead>
    <tr>
      <th>Action</th>
      <th>ID</th>
      <th>Title</th>
      <th>Show</th>
      <th>Subtitles</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
    <% @episodes.each do |episode| %>
      <% show = episode.show %>
      <tr>
        <td>
          <%= link_to('Edit', edit_admin_show_episode_path(episode.show, episode), class: 'btn btn-info') %>
        </td>
        <td><%= episode.id %></td>
        <td><%= episode.title %></td>
        <% if show.nil? %>
          <td>N/A</td>
          <td>N/A</td>
        <% else %>
          <td><%= link_to(show.get_title, edit_admin_show_path(show)) %></td>
          <td><%= episode.subtitles.empty? ? '- none -' : episode.subtitles.map{|s| s.name}.join(', ') %></td>
        <% end %>
        <td>
          <% @_rule = {class: nil} %>
          <% @_thumb_info = {} %>
          <% @model = episode %>
          <% @hide_title = true %>
          <%= render '/shows/partial/_thumbs' %>
        </td>
      </tr>
      <% end %>
  </tbody>
</table>

<script type="text/javascript">
  $(document).ready(function() {
    $('tables').DataTable({
      "paging":   false,
      "search":   false,
      "order": [[ 0, "desc" ]]
    });

    $('[add-option]').on('click', function(e) {
      e.preventDefault();
      if ($(this).attr('add-option') === 'from-files') {
        $('#current-episodes').addClass('d-none');
        $('#from-files').removeClass('d-none');
      }
    });


  });
</script>
